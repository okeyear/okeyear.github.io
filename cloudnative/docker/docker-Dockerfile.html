<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>docker008 Dockerfile详解 | Hello World</title>
    <meta name="description" content="okeyear blog">
    <link rel="stylesheet" href="/assets/style.d8cc85cb.css">
    <link rel="modulepreload" href="/assets/chunks/AlgoliaSearchBox.581e156b.js">
    <link rel="modulepreload" href="/assets/app.1b5e2894.js">
    <link rel="modulepreload" href="/assets/cloudnative_docker_docker-Dockerfile.md.4925ec37.lean.js">
    
    <meta name="twitter:title" content="docker008 Dockerfile详解 | Hello World">
  <meta property="og:title" content="docker008 Dockerfile详解 | Hello World">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="Hello World, back to home" data-v-675d8756 data-v-cc01ef16><!----> Hello World</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/" data-v-b8818f8c>Home <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>Linux</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/linux/command/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>command</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/linux/rootfs/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>rootfs</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/linux/service/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>service</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>CloudNative</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item active" href="/cloudnative/docker/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>docker</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/cloudnative/k8s/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>k8s</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/cloudnative/vmware/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>vmware</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/cloudnative/terraform/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>terraform</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/windows/" data-v-b8818f8c>Windows <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/netwok/" data-v-b8818f8c>Netwok <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/shell/" data-v-b8818f8c>Shell <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/powershell/" data-v-b8818f8c>PowerShell <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>Python</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/python/base/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>base</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/python/module/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>module</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>Web</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/html/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>HTML</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/css/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>CSS</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/javascript/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>JavaScript</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/es6/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>ES6</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/typescript/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>TypeScript</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/vue/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>Vue</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/vscode/" data-v-b8818f8c>VSCode <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>Game</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/game/poe/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>POE</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/game/d3/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>D3</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/game/ahk/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>AHK</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/about/" data-v-b8818f8c>About <!----></a></div></div><!--]--><!----><!----></nav></div><!--[--><!--[--><div class="algolia-search-box" id="docsearch"></div><!--]--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/" data-v-b8818f8c>Home <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>Linux</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/linux/command/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>command</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/linux/rootfs/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>rootfs</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/linux/service/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>service</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>CloudNative</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item active" href="/cloudnative/docker/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>docker</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/cloudnative/k8s/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>k8s</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/cloudnative/vmware/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>vmware</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/cloudnative/terraform/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>terraform</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/windows/" data-v-b8818f8c>Windows <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/netwok/" data-v-b8818f8c>Netwok <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/shell/" data-v-b8818f8c>Shell <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/powershell/" data-v-b8818f8c>PowerShell <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>Python</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/python/base/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>base</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/python/module/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>module</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>Web</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/html/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>HTML</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/css/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>CSS</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/javascript/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>JavaScript</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/es6/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>ES6</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/typescript/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>TypeScript</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/vue/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>Vue</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/vscode/" data-v-b8818f8c>VSCode <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>Game</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/game/poe/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>POE</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/game/d3/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>D3</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/game/ahk/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>AHK</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/about/" data-v-b8818f8c>About <!----></a></div></div><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><a class="sidebar-link-item" href="#dockerfile">Dockerfile</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#_1-from-基础镜像信息">1\. FROM 基础镜像信息</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_2-maintainer-维护者信息">2\. MAINTAINER 维护者信息</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_2-label-生成镜像的元数据标签">2\. LABEL 生成镜像的元数据标签</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_3-run-镜像操作指令">3 RUN 镜像操作指令</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_5-workdir">5 WORKDIR</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_4-cmd-容器启动时执行命令">4\. CMD 容器启动时执行命令</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_5-entrypoint-默认入口">5\. ENTRYPOINT 默认入口</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_6-expose-指定端口">6\. EXPOSE 指定端口</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_7-env-设置环境变量">7\. ENV 设置环境变量</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_8-add-从src复制文件到container的dest路径">8\. ADD 从src复制文件到container的dest路径</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_9-copy-拷贝文件或目录">9\. COPY 拷贝文件或目录</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_11-volume-数据卷挂载点">11\. VOLUME 数据卷挂载点</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_12-user-设置运行容器时的用户名或uid">12\. USER 设置运行容器时的用户名或UID</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_14-arg-定义变量">14\. ARG 定义变量</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_15-onbuild">15\. ONBUILD</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_16-stopsignal">16\. STOPSIGNAL</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_17-healthcheck">17\. HEALTHCHECK</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#_18-shell">18\. SHELL</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#windows中添加-建议">windows中添加(建议)</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#ubuntu中添加-建议">ubuntu中添加(建议)</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#使用dockerfiles创建镜像">使用Dockerfiles创建镜像</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#使用-dockerignore文件">使用.dockerignore文件</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#待整理">待整理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#虚悬镜像-dangling-image">虚悬镜像 dangling image</a><!----></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h1 id="docker008-dockerfile详解" tabindex="-1">docker008 Dockerfile详解 <a class="header-anchor" href="#docker008-dockerfile详解" aria-hidden="true">#</a></h1><p><a href="https://docs.docker.com/engine/reference/builder/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/engine/reference/builder</a></p><p><a href="https://k8s.coding3min.com/docker-jing-xiang/best-dockerfile" target="_blank" rel="noopener noreferrer">https://k8s.coding3min.com/docker-jing-xiang/best-dockerfile</a><a href="https://k8s.coding3min.com/docker-jing-xiang/best-dockerfile-other" target="_blank" rel="noopener noreferrer">https://k8s.coding3min.com/docker-jing-xiang/best-dockerfile-other</a></p><h2 id="dockerfile" tabindex="-1">Dockerfile <a class="header-anchor" href="#dockerfile" aria-hidden="true">#</a></h2><h3 id="_1-from-基础镜像信息" tabindex="-1">1. FROM 基础镜像信息 <a class="header-anchor" href="#_1-from-基础镜像信息" aria-hidden="true">#</a></h3><p>FROM命令可能是最重要的Dockerfile命令。改命令定义了使用哪个基础镜像启动构建流程。基础镜像可以为任意镜 像。如果基础镜像没有被发现，Docker将试图从Docker image index来查找该镜像。FROM命令必须是Dockerfile的首个命令。</p><div class="language-bash"><pre><code><span class="token comment"># 第一行必须指定基于的基础镜像</span>
<span class="token comment"># Usage: FROM [image name]</span>
FROM <span class="token operator">&lt;</span>image<span class="token operator">&gt;</span>:<span class="token operator">&lt;</span>tag<span class="token operator">&gt;</span> 
FROM <span class="token operator">&lt;</span>image<span class="token operator">&gt;</span>@digest校验码
</code></pre></div><h3 id="_2-maintainer-维护者信息" tabindex="-1">2. MAINTAINER 维护者信息 <a class="header-anchor" href="#_2-maintainer-维护者信息" aria-hidden="true">#</a></h3><p>这个命令用于声明作者，一般应该放在FROM的后面。</p><div class="language-bash"><pre><code><span class="token comment"># Usage: MAINTAINER [name]</span>
MAINTAINER authors_name email@emial.com
逐渐废弃， 
LABLE 替代 MAINTAINER 
</code></pre></div><h3 id="_2-label-生成镜像的元数据标签" tabindex="-1">2. LABEL 生成镜像的元数据标签 <a class="header-anchor" href="#_2-label-生成镜像的元数据标签" aria-hidden="true">#</a></h3><p>LABEL指定生成镜像的元数据标签信息</p><div class="language-bash"><pre><code>LABEL <span class="token operator">&lt;</span>key<span class="token operator">&gt;=</span><span class="token operator">&lt;</span>value<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>key<span class="token operator">&gt;=</span><span class="token operator">&lt;</span>value<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>key<span class="token operator">&gt;=</span><span class="token operator">&lt;</span>value<span class="token operator">&gt;</span> <span class="token punctuation">..</span>.
 一个Dockerfile种可以有多个LABEL
LABLE <span class="token assign-left variable">maintainer</span><span class="token operator">=</span><span class="token string">&quot;1@1.com&quot;</span>

LABEL multi.label1<span class="token operator">=</span><span class="token string">&quot;value1&quot;</span> <span class="token punctuation">\</span>
multi.label2<span class="token operator">=</span><span class="token string">&quot;value2&quot;</span> <span class="token punctuation">\</span>
<span class="token assign-left variable">other</span><span class="token operator">=</span><span class="token string">&quot;value3&quot;</span>
</code></pre></div><h3 id="_3-run-镜像操作指令" tabindex="-1">3 RUN 镜像操作指令 <a class="header-anchor" href="#_3-run-镜像操作指令" aria-hidden="true">#</a></h3><p>(运行指定命令用,即/bin/sh -c,安装软件用) 两种形式:</p><ul><li>run command shell格式</li><li>run [ &quot;executable&quot;,&quot;param1&quot;,&quot;param2&quot; ]后一种形式必须用双引号,因为会被解析成Json字符串. exec格式</li></ul><p>RUN命令是Dockerfile执行命令的核心部分。它接受命令作为参数并用于创建镜像。不像CMD命令，RUN命令用于创建镜像（在之前commit的层之上形成新的层）。</p><div class="language-bash"><pre><code><span class="token comment"># Usage: RUN [command]</span>
RUN <span class="token function">aptitude</span> <span class="token function">install</span> -y riak
RUN <span class="token punctuation">[</span> <span class="token string">&quot;/bin/bash&quot;</span>,<span class="token string">&quot;-c&quot;</span>,<span class="token string">&quot;echo hello&quot;</span> <span class="token punctuation">]</span>
</code></pre></div><h3 id="_5-workdir" tabindex="-1">5 WORKDIR <a class="header-anchor" href="#_5-workdir" aria-hidden="true">#</a></h3><p><a href="https://docs.docker.com/engine/reference/builder/#workdir" target="_blank" rel="noopener noreferrer">https://docs.docker.com/engine/reference/builder/#workdir</a></p><p>Docker默认工作目录是/。只有RUN能执行cd切换目录，而且还只作用当下的RUN。</p><p>也就是每一个RUN都是独进行的。</p><p>想让其他指令也在指定目录下运行，就需要WORKDIR</p><p>WORKDIR命令用于设置CMD指明的命令的运行目录。 设置指令，可以多次切换(相当于cd命令)，对RUN,CMD,ENTRYPOINT生效。 格式:</p><div class="language-bash"><pre><code>WORKDIR /path/to/workdir  
</code></pre></div><div class="language-bash"><pre><code>WORKDIR /a
WORKDIR b
WORKDIR c
RUN <span class="token builtin class-name">pwd</span>
</code></pre></div><p>pwd执行的结果是/a/b/c</p><p>WORKDIR也可以解析环境变量 如：</p><div class="language-Plain Text"><pre><code>ENV DIRPATH /path
WORKDIR $DIRPATH/$DIRNAME
RUN pwd
</code></pre></div><p>pwd的执行结果是/path/$DIRNAME</p><div class="language-bash"><pre><code>WORKDIR /usr/local/tomcat

</code></pre></div><h3 id="_4-cmd-容器启动时执行命令" tabindex="-1">4. CMD 容器启动时执行命令 <a class="header-anchor" href="#_4-cmd-容器启动时执行命令" aria-hidden="true">#</a></h3><p>（设置container启动时执行的操作） 三种格式:</p><ul><li>CMD [&quot;executable&quot;,&quot;param1&quot;,&quot;param2&quot;]使用exec执行,是推荐使用方式</li><li>CMD command param1 param2 在/bin/sh中执行,提供给需要交互的应用</li><li>CMD [&quot;param1&quot;,&quot;param2&quot;] 提供给ENTRYPOINT的默认参数</li></ul><p>指定容器启动时候执行的命令，每个Dockerfile只能有一个CMD命令。如果有多条，只有最后一条被执行。 如果用户启动容器时候指定了运行的命令，则会覆盖掉CMD指定的命令。</p><h3 id="_5-entrypoint-默认入口" tabindex="-1">5. ENTRYPOINT 默认入口 <a class="header-anchor" href="#_5-entrypoint-默认入口" aria-hidden="true">#</a></h3><p>指定镜像的默认入口命令.启动容器时作为跟命令执行.</p><p>格式1(exec调用执行)：</p><div class="language-bash"><pre><code>ENTRYPOINT <span class="token punctuation">[</span><span class="token string">&quot;executable&quot;</span>, <span class="token string">&quot;param1&quot;</span>, <span class="token string">&quot;param2&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">(</span>like an exec, the preferred form<span class="token punctuation">)</span>  
</code></pre></div><p>格式2(shell中执行.CMD指令指定值作为参数)：</p><div class="language-bash"><pre><code>ENTRYPOINT <span class="token builtin class-name">command</span> param1 param2 <span class="token punctuation">(</span>as a shell<span class="token punctuation">)</span>  <span class="token punctuation">[</span>CMD Args<span class="token punctuation">]</span>
</code></pre></div><p>当独自使用时，如果你还使用了CMD命令且CMD是一个完整的可执行的命令，那么CMD指令和ENTRYPOINT会互相覆盖只有最后一个CMD或者ENTRYPOINT有效。</p><p>ENTRYPOINT 帮助你配置一个容器使之可执行化，如果你结合CMD命令和ENTRYPOINT命令，你可以从CMD命令中移除“application”而仅仅保留参数，参数将传递给ENTRYPOINT命令。</p><div class="language-bash"><pre><code><span class="token comment"># Usage: ENTRYPOINT application &quot;argument&quot;, &quot;argument&quot;, ..</span>
<span class="token comment"># Remember: arguments are optional. They can be provided by CMD</span>
<span class="token comment"># or during the creation of a container.</span>
ENTRYPOINT <span class="token builtin class-name">echo</span>
<span class="token comment"># Usage example with CMD:</span>
<span class="token comment"># Arguments set with CMD can be overridden during *run*</span>
CMD <span class="token string">&quot;Hello docker!&quot;</span>
ENTRYPOINT <span class="token builtin class-name">echo</span>

<span class="token comment"># CMD指令将不会被执行，只有ENTRYPOINT指令被执行  </span>
CMD <span class="token builtin class-name">echo</span> “Hello, World<span class="token operator">!</span>”  
ENTRYPOINT <span class="token function">ls</span> -l  
另一种用法和CMD指令配合使用来指定ENTRYPOINT的默认参数，这时CMD指令不是一个完整的可执行命令，仅仅是参数部分；ENTRYPOINT指令只能使用JSON方式指定执行命令，而不能指定参数。
FROM ubuntu  
CMD <span class="token punctuation">[</span><span class="token string">&quot;-l&quot;</span><span class="token punctuation">]</span>  
ENTRYPOINT <span class="token punctuation">[</span><span class="token string">&quot;/usr/bin/ls&quot;</span><span class="token punctuation">]</span>  

</code></pre></div><h3 id="_6-expose-指定端口" tabindex="-1">6. EXPOSE 指定端口 <a class="header-anchor" href="#_6-expose-指定端口" aria-hidden="true">#</a></h3><p>注意: 只声明,并不会自动完成端口映射 EXPOSE用来指定端口，使容器内的应用可以通过端口和外界交互。与启动容器的-P -p配合使用。</p><p>设置指令，该指令会将容器中的端口映射成宿主机器中的某个端口。当你需要访问容器的时候，可以不是用容器的IP地址而是使用宿主机器的IP地址和映射后的端口。</p><p>要完成整个操作需要两个步骤:</p><ul><li>首先在Dockerfile使用EXPOSE设置需要映射的容器端口</li><li>然后在运行容器的时候指定-p选项加上EXPOSE设置的端口</li></ul><p>这样EXPOSE设置的端口号会被随机映射成宿主机器中的一个端口号。也可以指定需要映射到宿主机器的那个端口，这时要确保宿主机器上的端口号没有被使用。 EXPOSE指令可以一次设置多个端口号，相应的运行容器的时候，可以配套的多次使用-p选项。</p><div class="language-bash"><pre><code><span class="token comment"># Usage: EXPOSE [port/tcp port/udp] 默认为tcp</span>
<span class="token comment"># 映射一个端口  </span>
EXPOSE port1  
<span class="token comment"># 相应的运行容器使用的命令  </span>
<span class="token function">docker</span> run -p port1 image  

<span class="token comment"># 映射多个端口  </span>
EXPOSE port1 port2 port3  
<span class="token comment"># 相应的运行容器使用的命令  </span>
<span class="token function">docker</span> run -p port1 -p port2 -p port3 image  
<span class="token comment"># 还可以指定需要映射到宿主机器上的某个端口号  </span>
<span class="token function">docker</span> run -p host_port1:port1 -p host_port2:port2 -p host_port3:port3 image  

</code></pre></div><h3 id="_7-env-设置环境变量" tabindex="-1">7. ENV 设置环境变量 <a class="header-anchor" href="#_7-env-设置环境变量" aria-hidden="true">#</a></h3><p>ENV命令用于设置环境变量。这些变量以key=value的形式存在，并可以在容器内被脚本或者程序调用。这个机制给在容器中运行应用带来了极大的便利。</p><div class="language-bash"><pre><code><span class="token comment"># Usage: ENV key value</span>
<span class="token comment"># Usage: ENV key=value</span>
ENV SERVER_WORKS <span class="token number">4</span>
ENV JAVA_HOME /usr/local/jdk
ENV XX_ver <span class="token number">1.1</span>
RUN <span class="token function">curl</span> -SL http://xxxxx.xxx/xxx-<span class="token variable">$XX_ver</span>.tar.gz <span class="token operator">|</span> <span class="token function">tar</span> -xJC /user/src/xxx <span class="token operator">&amp;&amp;</span> <span class="token punctuation">..</span>.
ENV <span class="token environment constant">PATH</span> /user/local/xxx_<span class="token variable">$XX_ver</span>/bin:<span class="token environment constant">$PATH</span>

<span class="token comment"># 可以用docker inspect命令查看</span>
</code></pre></div><p>注意: dokcer run --env k=v时候会覆盖掉</p><h3 id="_8-add-从src复制文件到container的dest路径" tabindex="-1">8. ADD 从src复制文件到container的dest路径 <a class="header-anchor" href="#_8-add-从src复制文件到container的dest路径" aria-hidden="true">#</a></h3><p>ADD命令有两个参数，源和目标。它的基本作用是从源系统的文件系统上复制文件到目标容器的文件系统。</p><ul><li>如果是文件或文件夹,复制</li><li>如果源是一个URL，那该URL的内容将被下载并复制到容器中。</li><li>如果是tar文件,自动解压到dest路径下</li></ul><p>dest可以是镜像内的绝对路径,或者相对于工作目录(WORKDIR)的相对路径</p><div class="language-bash"><pre><code><span class="token comment"># Usage: ADD &lt;src&gt; &lt;dest&gt;</span>
<span class="token comment"># Usage: ADD [source directory or URL] [destination directory]</span>

ADD /my_app_folder /my_app_folder CMD
</code></pre></div><p>和RUN命令相似，CMD可以用于执行特定的命令。和RUN不同的是，这些命令不是在镜像构建的过程中执行的，而是在用镜像构建容器后被调用。 当目标路径不存在时，会自动创建；当使用本地目录为源目录时，推荐使用COPY。</p><h3 id="_9-copy-拷贝文件或目录" tabindex="-1">9. COPY 拷贝文件或目录 <a class="header-anchor" href="#_9-copy-拷贝文件或目录" aria-hidden="true">#</a></h3><div class="language-bash"><pre><code>COPY <span class="token operator">&lt;</span>src<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>dest<span class="token operator">&gt;</span>
</code></pre></div><p>命令有两个参数，源和目标。它的基本作用是从源系统的文件系统上复制文件到目标容器的文件系统。 src为绝对路径或者Dockerfile所在目录的相对路径，文件或目录。 路径支持正则格式. 当使用本地目录为源目录时，推荐使用COPY。</p><h3 id="_11-volume-数据卷挂载点" tabindex="-1">11. VOLUME 数据卷挂载点 <a class="header-anchor" href="#_11-volume-数据卷挂载点" aria-hidden="true">#</a></h3><p>VOLUME命令用于让你的容器访问宿主机上的目录。</p><div class="language-Plain Text"><pre><code># Usage: VOLUME [&quot;/dir_1&quot;, &quot;/dir_2&quot; ..]
VOLUME [&quot;/my_files&quot;]
VOLUME [&quot;/var/log/&quot;]
VOLUME /var/log
VOLUME /var/log /var/db

</code></pre></div><h3 id="_12-user-设置运行容器时的用户名或uid" tabindex="-1">12. USER 设置运行容器时的用户名或UID <a class="header-anchor" href="#_12-user-设置运行容器时的用户名或uid" aria-hidden="true">#</a></h3><p>USER命令用于设置运行容器时的用户名或UID。</p><div class="language-bash"><pre><code><span class="token comment"># Usage: USER [UID]</span>
<span class="token environment constant">USER</span> <span class="token number">751</span>
设置指令，设置启动容器的用户，默认是root用户。
<span class="token comment"># 指定memcached的运行用户  </span>
ENTRYPOINT <span class="token punctuation">[</span><span class="token string">&quot;memcached&quot;</span><span class="token punctuation">]</span>  
<span class="token environment constant">USER</span> daemon  
或  
ENTRYPOINT <span class="token punctuation">[</span><span class="token string">&quot;memcached&quot;</span>, <span class="token string">&quot;-u&quot;</span>, <span class="token string">&quot;daemon&quot;</span><span class="token punctuation">]</span>  
</code></pre></div><h3 id="_14-arg-定义变量" tabindex="-1">14. ARG 定义变量 <a class="header-anchor" href="#_14-arg-定义变量" aria-hidden="true">#</a></h3><div class="language-Plain Text"><pre><code>ARG &lt;name&gt;[=&lt;default value&gt;]
</code></pre></div><p>设置变量命令，ARG命令定义了一个变量，在docker build创建镜像的时候，使用 --build-arg=来指定参数 如果用户在build镜像时指定了一个参数没有定义在Dockerfile中，那么将有一个Warning [Warning] One or more build-args [foo] were not consumed. 如果我们给了ARG定义的参数默认值，那么当build镜像时没有指定参数值，将会使用这个默认值</p><div class="language-bash"><pre><code>我们可以定义一个或多个参数，如下：
FROM busybox
ARG user1
ARG buildno

也可以给参数一个默认值：

FROM busybox
ARG <span class="token assign-left variable">user1</span><span class="token operator">=</span>someuser
ARG <span class="token assign-left variable">buildno</span><span class="token operator">=</span><span class="token number">1</span>
</code></pre></div><p>docker build --build-arg name=value来传入</p><h3 id="_15-onbuild" tabindex="-1">15. ONBUILD <a class="header-anchor" href="#_15-onbuild" aria-hidden="true">#</a></h3><p>当前镜像作为其他镜像的基础镜像时,锁执行的创建操作指令.</p><div class="language-Plain Text"><pre><code>ONBUILD [INSTRUCTION]
</code></pre></div><p>这个命令只对当前镜像的子镜像生效。 比如当前镜像为A，在Dockerfile种添加：</p><div class="language-Plain Text"><pre><code>ONBUILD RUN ls -al
</code></pre></div><p>这个 ls -al 命令不会在A镜像构建或启动的时候执行 此时有一个镜像B是基于A镜像构建的，那么这个ls -al 命令会在B镜像构建的时候被执行。</p><div class="language-Plain Text"><pre><code># image-A
ONBUILD ADD . /app/src
ONBUILD RUN /usr/local/bin/python-build --dir /app/src

</code></pre></div><p>如果B中</p><div class="language-Plain Text"><pre><code>FROM image-A
# 会自动执行如下
ADD . /app/src
RUN /usr/local/bin/python-build --dir /app/src

</code></pre></div><p>使用ONBUILD的镜像,推荐在标签中注明,比如ruby:1.9-onbuild</p><h3 id="_16-stopsignal" tabindex="-1">16. STOPSIGNAL <a class="header-anchor" href="#_16-stopsignal" aria-hidden="true">#</a></h3><p>STOPSIGNAL命令是的作用是当容器停止时给系统发送什么样的指令，默认是15</p><div class="language-Plain Text"><pre><code>STOPSIGNAL signal
</code></pre></div><h3 id="_17-healthcheck" tabindex="-1">17. HEALTHCHECK <a class="header-anchor" href="#_17-healthcheck" aria-hidden="true">#</a></h3><p>容器健康状况检查命令 语法有两种：</p><ul><li>HEALTHCHECK [OPTIONS] CMD command 容器内运行一个命令,根据返回值是否为0来判断</li><li>HEALTHCHECK NONE 禁止基础镜像中的健康检查</li><li>[OPTIONS]的选项支持以下三中选项：</li></ul><div class="language-Plain Text"><pre><code>–interval=DURATION 两次检查默认的时间间隔为30秒
–timeout=DURATION 健康检查命令运行超时时长，默认30秒
–retries=N 当连续失败指定次数后，则容器被认为是不健康的，状态为unhealthy，默认次数是3
</code></pre></div><p>HEALTHCHECK命令只能出现一次，如果出现了多次，只有最后一个生效。 CMD后边的命令的返回值决定了本次健康检查是否成功，具体的返回值如下： 0: success - 表示容器是健康的 1: unhealthy - 表示容器已经不能工作了 2: reserved - 保留值</p><p>例子：</p><div class="language-Plain Text"><pre><code>HEALTHCHECK --interval=5m --timeout=3s \
CMD curl -f http://localhost/ || exit 1
健康检查命令是：curl -f http://localhost/ || exit 1
两次检查的间隔时间是5秒
命令超时时间为3秒
</code></pre></div><h3 id="_18-shell" tabindex="-1">18. SHELL <a class="header-anchor" href="#_18-shell" aria-hidden="true">#</a></h3><p>指定其他命令使用shell时的默认shell类型</p><div class="language-Plain Text"><pre><code>SHELL [&quot;executable&quot;, &quot;parameters&quot;] 
默认值为
SHELL [&quot;/bin/sh&quot;, &quot;-c&quot;]
</code></pre></div><h3 id="windows中添加-建议" tabindex="-1">windows中添加(建议) <a class="header-anchor" href="#windows中添加-建议" aria-hidden="true">#</a></h3><div class="language-Plain Text"><pre><code># escape=` 来指定转义信息

</code></pre></div><h3 id="ubuntu中添加-建议" tabindex="-1">ubuntu中添加(建议) <a class="header-anchor" href="#ubuntu中添加-建议" aria-hidden="true">#</a></h3><div class="language-Plain Text"><pre><code>ENV DEBIAN_FRONTEND noninteractive
#设置环境变量，所有操作都是非交互式的
RUN echo &quot;Asia/Shanghai&quot; &gt; /etc/timezone &amp;&amp; \
dpkg-reconfigure -f noninteractive tzdata
#注意这里要更改系统的时区设置，因为在Web应用中经常会用到时区这个系统变量，默认的ubuntu会让应用发生不可思议的效果。
</code></pre></div><h2 id="使用dockerfiles创建镜像" tabindex="-1">使用Dockerfiles创建镜像 <a class="header-anchor" href="#使用dockerfiles创建镜像" aria-hidden="true">#</a></h2><ul><li>注意一个镜像不能超过 127 层 使用Dockerfiles和手工使用Docker Daemon运行命令一样简单。脚本运行后输出为新的镜像ID。 另外，可以通过 .dockerignore文件（每一行添加一条匹配模式）来让Docker忽略路径下的目录和文件。</li></ul><div class="language-bash"><pre><code><span class="token comment"># Build an image using the Dockerfile at current location</span>
<span class="token comment"># Example: sudo docker build -t [name] .</span>
<span class="token function">sudo</span> <span class="token function">docker</span> build -t my_mongodb <span class="token builtin class-name">.</span> 
$ <span class="token function">sudo</span> <span class="token function">docker</span> build -t<span class="token operator">=</span><span class="token string">&quot;ouruser/sinatra:v2&quot;</span> <span class="token builtin class-name">.</span>
</code></pre></div><ul><li>t 标记来添加 tag，指定新的镜像的用户信息。 &quot;.&quot; 是 Dockerfile 所在的路径（当前目录）,build时候的上下文目录</li><li>f 指定具体的 Dockerfile 的路径。 可以看到 build 进程在执行操作。它要做的第一件事情就是上传这个 Dockerfile 内容，因为所有的操作都要依据 Dockerfile 来进行。 然后，Dockfile 中的指令被一条一条的执行。每一步都创建了一个新的容器，在容器中执行指令并提交修改（就跟之前介绍过的 docker commit 一样）。当所有的指令都执行完毕之后，返回了最终的镜像 id。所有的中间步骤所产生的容器都被删除和清理了。</li></ul><h2 id="使用-dockerignore文件" tabindex="-1">使用.dockerignore文件 <a class="header-anchor" href="#使用-dockerignore文件" aria-hidden="true">#</a></h2><p>.dockerignore 文件中指定在传递给 docker引擎 时需要忽略掉的文件或文件夹。</p><div class="language-Plain Text"><pre><code>#comment

#代表根目录（上下文环境目录中）中以abc开头的任意直接子目录或者直接子文件将被忽略
#如/abc  abc.txt
/abc*

#代表根目录（上下文环境目录中）中任意直接子目录中以abc开头的任意直接子目录或者直接子文件将被忽略
#如 /file/abc  /file/abc.txt
*/abc*

#代表根目录（上下文环境目录中）中任意两级目录下以abc开头的任意直接子目录或者直接子文件将被忽略
#如 /file1/file2/abc  /file1/file2/abc.txt
*/*/abc*

#排除根目录中的文件和目录，其名称是单字符扩展名temp。例如，/tempa与/tempb被排除在外。
temp?    

#Docker还支持一个**匹配任意数量目录（包括零）的特殊通配符字符串
**/abc*

#以!（感叹号）开头的行可用于对排除项进行例外处理,比如原本包含了README.md这个文件的过滤，但是加了如下一行后
#就不会再过滤README.md，依然会将其提交到守护进程。
!README.md

#异常规则的放置位置会影响行为
*.md
!README*.md
README-secret.md
#README-secret.md 仍然会被忽略

*.md
README-secret.md
!README*.md
#README-secret.md 不会被忽略

您甚至可以使用该.dockerignore文件来排除Dockerfile和.dockerignore文件。这些文件仍然发送到守护程序，因为它需要它们来完成它的工作。但是ADD和COPY命令不会将它们复制到图像中。
</code></pre></div><h2 id="待整理" tabindex="-1">待整理 <a class="header-anchor" href="#待整理" aria-hidden="true">#</a></h2><div class="language-Plain Text"><pre><code># put my local web site in myApp folder to /var/www
ADD myApp /var/www
# expose httpd port
EXPOSE 80
# the command to run
CMD [&quot;/usr/sbin/apachectl&quot;, &quot;-D&quot;, &quot;FOREGROUND&quot;]
</code></pre></div><div class="language-Plain Text"><pre><code>#让Nginx运行在非Daemon模式
RUN echo &quot;ndaemon off;&quot; &gt;&gt; /etc/nginx/nginx.conf


dpkg-reconfigure(选项)(参数) -a：重新配置所有的软件包；
-u或--unseen-only：仅显示未提过的问题；
--default-priority：使用默认优先级，而非“低”级；
--force：强制执行操作，需谨慎使用此选项；
--no-reload：不要轻易的重装模板（使用时请慎重考虑）；
-f或--frontend：指定 debconf 前端界面；
-p或--priority：指定要显示的问题的最优先级；
--terse：开启简要模式。
</code></pre></div><h2 id="虚悬镜像-dangling-image" tabindex="-1">虚悬镜像 dangling image <a class="header-anchor" href="#虚悬镜像-dangling-image" aria-hidden="true">#</a></h2><p>docker pull或者docker image导致标签被新的镜像拿走， 老的镜像既没有仓库名，也没有标签名；</p><p>可以通过如下方式删除</p><div class="language-bash"><pre><code><span class="token function">docker</span> image prune
</code></pre></div></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-07c132fc><div class="edit" data-v-07c132fc><div class="edit-link" data-v-07c132fc data-v-1ed99556><!----></div></div><div class="updated" data-v-07c132fc><!----></div></footer><!----><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"cloudnative_docker_docker-dockerfile.md\":\"4925ec37\",\"cloudnative_docker_docker-container.md\":\"5ee53bff\",\"cloudnative_docker_docker-image-mysql.md\":\"6d099375\",\"cloudnative_docker_docker-image-tomcat.md\":\"f80b5282\",\"cloudnative_docker_docker-image.md\":\"ba22e7a6\",\"cloudnative_docker_docker-install.md\":\"51eac041\",\"cloudnative_docker_docker-registry.md\":\"e4d4ae79\",\"cloudnative_docker_docker-volume.md\":\"8a5aed54\",\"cloudnative_docker_index.md\":\"852732d2\",\"cloudnative_k8s_index.md\":\"bd53bffa\",\"cloudnative_terraform_index.md\":\"21d60000\",\"cloudnative_vmware_index.md\":\"281b04b2\",\"game_ahk_index.md\":\"ad30afa7\",\"game_d3_index.md\":\"e8cd897c\",\"game_poe_index.md\":\"a39c290d\",\"index.md\":\"b1c5988d\",\"linux_command_index.md\":\"72dcb0b5\",\"linux_command_jjj_join.md\":\"7702da87\",\"linux_command_nnn_nc.md\":\"8e662374\",\"linux_index.md\":\"98b8772d\",\"linux_rootfs_index.md\":\"27cfefb3\",\"linux_service_index.md\":\"2e704dc3\",\"linux_service_sss_ssh-tunnel.md\":\"1e8a24dd\",\"linux_service_sss_ssh.md\":\"f96d1cc9\",\"network_index.md\":\"69f782aa\",\"powershell_index.md\":\"0701d171\",\"python_base_index.md\":\"36475a10\",\"python_index.md\":\"928bee80\",\"python_module_index.md\":\"3fe9e242\",\"shell_index.md\":\"53acbcaa\",\"vscode_index.md\":\"34286ca6\",\"web_css_index.md\":\"735ced74\",\"web_es6_index.md\":\"dc13ef4e\",\"web_html_index.md\":\"66f12a69\",\"web_index.md\":\"150c74b5\",\"web_javascript_index.md\":\"e1c3c7a2\",\"web_typescript_index.md\":\"8ba6816a\",\"web_vue_index.md\":\"ba01f393\",\"windows_index.md\":\"5afcb7b6\",\"windows_software.md\":\"2e593c66\"}")</script>
    <script type="module" async src="/assets/app.1b5e2894.js"></script>
    
  </body>
</html>