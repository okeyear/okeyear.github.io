<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>docker002 install 安装和配置 | Hello World</title>
    <meta name="description" content="okeyear blog">
    <link rel="stylesheet" href="/assets/style.d8cc85cb.css">
    <link rel="modulepreload" href="/assets/chunks/AlgoliaSearchBox.c6c06635.js">
    <link rel="modulepreload" href="/assets/app.3a9754ab.js">
    <link rel="modulepreload" href="/assets/cloudnative_docker_docker-install.md.6cba41c5.lean.js">
    
    <meta name="twitter:title" content="docker002 install 安装和配置 | Hello World">
  <meta property="og:title" content="docker002 install 安装和配置 | Hello World">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="Hello World, back to home" data-v-675d8756 data-v-cc01ef16><!----> Hello World</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/" data-v-b8818f8c>Home <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>Linux</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/linux/distro/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>Distro</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/linux/command/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>Command</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/linux/rootfs/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>RootFS</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/linux/service/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>Service</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>CloudNative</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item active" href="/cloudnative/docker/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>Docker</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/cloudnative/k8s/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>K8S</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/cloudnative/vmware/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>VMWare</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/cloudnative/terraform/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>Terraform</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/windows/" data-v-b8818f8c>Windows <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/netwok/" data-v-b8818f8c>Netwok <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/shell/" data-v-b8818f8c>Shell <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/powershell/" data-v-b8818f8c>PowerShell <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>Python</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/python/base/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>Base</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/python/module/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>Module</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>Web</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/html/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>HTML</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/css/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>CSS</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/javascript/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>JavaScript</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/es6/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>ES6</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/typescript/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>TypeScript</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/vue/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>Vue</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/vscode/" data-v-b8818f8c>VSCode <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>Game</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/game/poe/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>POE</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/game/d3/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>D3</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/game/ahk/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>AHK</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/about/" data-v-b8818f8c>About <!----></a></div></div><!--]--><!----><!----></nav></div><!--[--><!--[--><div class="algolia-search-box" id="docsearch"></div><!--]--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/" data-v-b8818f8c>Home <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>Linux</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/linux/distro/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>Distro</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/linux/command/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>Command</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/linux/rootfs/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>RootFS</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/linux/service/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>Service</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>CloudNative</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item active" href="/cloudnative/docker/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>Docker</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/cloudnative/k8s/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>K8S</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/cloudnative/vmware/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>VMWare</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/cloudnative/terraform/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>Terraform</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/windows/" data-v-b8818f8c>Windows <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/netwok/" data-v-b8818f8c>Netwok <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/shell/" data-v-b8818f8c>Shell <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/powershell/" data-v-b8818f8c>PowerShell <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>Python</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/python/base/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>Base</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/python/module/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>Module</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>Web</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/html/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>HTML</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/css/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>CSS</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/javascript/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>JavaScript</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/es6/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>ES6</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/typescript/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>TypeScript</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/web/vue/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>Vue</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/vscode/" data-v-b8818f8c>VSCode <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-dropdown-link" data-v-eab3edfe data-v-56bf3a3f><button class="button" data-v-56bf3a3f><span class="button-text" data-v-56bf3a3f>Game</span><span class="right button-arrow" data-v-56bf3a3f></span></button><ul class="dialog" data-v-56bf3a3f><!--[--><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/game/poe/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>POE</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/game/d3/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>D3</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><li class="dialog-item" data-v-56bf3a3f><div class="nav-dropdown-link-item" data-v-56bf3a3f data-v-bbc27490><a class="item" href="/game/ahk/" data-v-bbc27490><span class="arrow" data-v-bbc27490></span><span class="text" data-v-bbc27490>AHK</span><span class="icon" data-v-bbc27490><!----></span></a></div></li><!--]--></ul></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/about/" data-v-b8818f8c>About <!----></a></div></div><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><a class="sidebar-link-item" href="#安装docker">安装docker</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#docker官方脚本安装">docker官方脚本安装</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#ubuntu安装">ubuntu安装</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#centos安装">centos安装</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#开机自启动">开机自启动</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#配置docker服务">配置docker服务</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#非特权运行">非特权运行</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#默认配置文件">默认配置文件</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#修改docker-opts">修改DOCKER_OPTS</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#镜像加速器">镜像加速器</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#配置docker-cgroup驱动systemd">配置docker cgroup驱动systemd</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#配置docker-proxy代理">配置docker proxy代理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#配置docker-container使用的-proxy代理">配置docker container使用的 proxy代理</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#第一个镜像">第一个镜像</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h1 id="docker002-install-安装和配置" tabindex="-1">docker002 install 安装和配置 <a class="header-anchor" href="#docker002-install-安装和配置" aria-hidden="true">#</a></h1><p>官方文档: <a href="https://docs.docker.com/engine/install/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/engine/install/</a></p><h2 id="安装docker" tabindex="-1">安装docker <a class="header-anchor" href="#安装docker" aria-hidden="true">#</a></h2><h3 id="docker官方脚本安装" tabindex="-1">docker官方脚本安装 <a class="header-anchor" href="#docker官方脚本安装" aria-hidden="true">#</a></h3><p><a href="https://github.com/okeyear/scripts/blob/main/shell/install_docker.sh" target="_blank" rel="noopener noreferrer">https://github.com/okeyear/scripts/blob/main/shell/install_docker.sh</a></p><div class="language-bash"><pre><code><span class="token function">curl</span> -fsSL get.docker.com <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">sh</span> -

<span class="token function">curl</span> -fsSL get.docker.com -o get-docker.sh
<span class="token function">sudo</span> <span class="token function">sh</span> get-docker.sh --mirror Aliyun
<span class="token comment"># sudo sh get-docker.sh --mirror AzureChinaCloud</span>
</code></pre></div><h3 id="ubuntu安装" tabindex="-1">ubuntu安装 <a class="header-anchor" href="#ubuntu安装" aria-hidden="true">#</a></h3><div class="language-bash"><pre><code><span class="token comment"># delete old version</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> remove <span class="token function">docker</span> docker-engine docker.io containerd runc

<span class="token comment"># step 1: 安装必要的一些系统工具</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> update
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token punctuation">\</span>
    ca-certificates <span class="token punctuation">\</span>
    <span class="token function">curl</span> <span class="token punctuation">\</span>
    gnupg <span class="token punctuation">\</span>
    lsb-release
    
<span class="token comment"># step 2: 安装GPG证书</span>
<span class="token comment"># curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo apt-key add -</span>
<span class="token function">sudo</span> <span class="token function">mkdir</span> -p /etc/apt/keyrings
<span class="token function">curl</span> -fsSL https://download.docker.com/linux/ubuntu/gpg <span class="token operator">|</span> <span class="token function">sudo</span> gpg --dearmor -o /etc/apt/keyrings/docker.gpg

<span class="token comment"># Step 3: 写入软件源信息</span>
<span class="token builtin class-name">echo</span> <span class="token punctuation">\</span>
  <span class="token string">&quot;deb [arch=<span class="token variable"><span class="token variable">$(</span>dpkg --print-architecture<span class="token variable">)</span></span> signed-by=/etc/apt/keyrings/docker.gpg] https://mirrors.aliyun.com/docker-ce/linux/ubuntu <span class="token variable"><span class="token variable">$(</span>lsb_release -cs<span class="token variable">)</span></span> stable&quot;</span> <span class="token operator">|</span> <span class="token punctuation">\</span>
  <span class="token function">sudo</span> <span class="token function">tee</span> /etc/apt/sources.list.d/docker.list <span class="token operator">&gt;</span> /dev/null

<span class="token comment"># Step 4: 更新并安装Docker-CE</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> update
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> docker-ce docker-ce-cli containerd.io docker-compose-plugin

</code></pre></div><h3 id="centos安装" tabindex="-1">centos安装 <a class="header-anchor" href="#centos安装" aria-hidden="true">#</a></h3><div class="language-bash"><pre><code><span class="token comment"># https://download.docker.com/linux/centos/docker-ce.repo</span>
<span class="token comment"># step 1: 安装必要的一些系统工具</span>
<span class="token function">sudo</span> yum <span class="token function">install</span> -y yum-utils device-mapper-persistent-data lvm2
<span class="token comment"># Step 2: 添加软件源信息</span>
<span class="token comment"># wget -O /etc/yum.repos.d/docker-ce.repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span>
<span class="token function">sudo</span> yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
<span class="token comment"># Step 3</span>
<span class="token function">sudo</span> <span class="token function">sed</span> -i <span class="token string">&#39;s+download.docker.com+mirrors.aliyun.com/docker-ce+&#39;</span> /etc/yum.repos.d/docker-ce.repo
<span class="token comment"># Step 4: 更新并安装Docker-CE</span>
<span class="token function">sudo</span> yum -y <span class="token function">install</span> docker-ce docker-ce-cli containerd.io docker-compose-plugin
<span class="token function">sudo</span> yum <span class="token function">install</span> docker-ce
<span class="token comment"># Step 4: 开启Docker服务</span>
<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> --now <span class="token function">docker</span>
<span class="token function">sudo</span> systemctl status <span class="token function">docker</span>


<span class="token comment"># container-selinux</span>
<span class="token comment"># yum install -y http://mirror.centos.org/centos/7/extras/x86_64/Packages/container-selinux-2.119.2-1.911c772.el7_8.noarch.rpm</span>
<span class="token comment"># yum install -y http://mirror.centos.org/centos/7/extras/x86_64/Packages/slirp4netns-0.4.3-4.el7_8.x86_64.rpm</span>
<span class="token comment"># yum install -y http://mirror.centos.org/centos/7/extras/x86_64/Packages/fuse-overlayfs-0.7.2-6.el7_8.x86_64.rpm</span>


<span class="token comment"># 新版本会自动解决依赖, 不需要以下部分了</span>
<span class="token comment"># centos8需要额外的依赖containerd.io</span>
<span class="token comment"># firefox https://download.docker.com/linux/fedora/35/x86_64/stable/Packages</span>
<span class="token comment"># fedora/35/上的有问题， 继续使用fedora/31上面的最新版本</span>
<span class="token comment"># yum install https://download.docker.com/linux/fedora/35/x86_64/stable/Packages/containerd.io-1.4.12-3.1.fc35.x86_64.rpm</span>
<span class="token comment"># sudo yum install -y https://download.docker.com/linux/fedora/31/x86_64/stable/Packages/containerd.io-1.4.3-3.1.fc31.x86_64.rpm</span>

</code></pre></div><h3 id="开机自启动" tabindex="-1">开机自启动 <a class="header-anchor" href="#开机自启动" aria-hidden="true">#</a></h3><div class="language-bash"><pre><code>systemctl start <span class="token function">docker</span>
systemctl <span class="token builtin class-name">enable</span> <span class="token function">docker</span>
systemctl is-enabled <span class="token function">docker</span>
<span class="token function">docker</span> version
</code></pre></div><h2 id="配置docker服务" tabindex="-1">配置docker服务 <a class="header-anchor" href="#配置docker服务" aria-hidden="true">#</a></h2><h3 id="非特权运行" tabindex="-1">非特权运行 <a class="header-anchor" href="#非特权运行" aria-hidden="true">#</a></h3><p>把当前用户加入docker组</p><div class="language-bash"><pre><code><span class="token function">sudo</span> <span class="token function">usermod</span> -aG <span class="token function">docker</span> <span class="token environment constant">$USER</span>
<span class="token comment"># 如果已经sudo到root,请执行如下</span>
<span class="token function">sudo</span> <span class="token function">usermod</span> -aG <span class="token function">docker</span> <span class="token variable">$SUDO_USER</span>
</code></pre></div><h3 id="默认配置文件" tabindex="-1">默认配置文件 <a class="header-anchor" href="#默认配置文件" aria-hidden="true">#</a></h3><p>Centos系统的配置 /etc/sysconfig/docker</p><p>Ubuntu系统的配置 /etc/default/docker</p><p>配置文件完整参考 <a href="https://docs.docker.com/engine/reference/commandline/dockerd/#options" target="_blank" rel="noopener noreferrer">https://docs.docker.com/engine/reference/commandline/dockerd/#options</a></p><h3 id="修改docker-opts" tabindex="-1">修改DOCKER_OPTS <a class="header-anchor" href="#修改docker-opts" aria-hidden="true">#</a></h3><ul><li>监听地址,允许本地2375端口接收远程连接 <a href="https://docs.docker.com/engine/reference/commandline/dockerd/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/engine/reference/commandline/dockerd/</a> 一般需要配合CA证书或者ssh隧道加密使用, 别直接暴漏2375端口</li></ul><div class="language-Plain Text"><pre><code>DOCKER_OPTS=&quot;$DOCKER_OPTS -H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock&quot;
</code></pre></div><ul><li>配置文件json则是:</li></ul><div class="language-Plain Text"><pre><code>&quot;hosts&quot;: [&quot;unix:///var/run/docker.sock&quot;,&quot;tcp://0.0.0.0:2375&quot;]
</code></pre></div><ul><li>非官方仓库的信任 编辑docker配置文件，加入</li></ul><div class="language-Plain Text"><pre><code>DOCKER_OPTS=&#39;--insecure-registry dl.dockerpool.com:5000&#39;
</code></pre></div><h3 id="镜像加速器" tabindex="-1">镜像加速器 <a class="header-anchor" href="#镜像加速器" aria-hidden="true">#</a></h3><p>docker官方中国区 <a href="https://registry.docker-cn.com/" target="_blank" rel="noopener noreferrer">https://registry.docker-cn.com</a></p><p>网易 <a href="http://hub-mirror.c.163.com/" target="_blank" rel="noopener noreferrer">http://hub-mirror.c.163.com</a></p><p>ustc <a href="http://docker.mirrors.ustc.edu.cn/" target="_blank" rel="noopener noreferrer">http://docker.mirrors.ustc.edu.cn</a></p><p>阿里云 http://&lt;你的ID&gt;.mirror.aliyuncs.com</p><ul><li><p>官方 &quot;<a href="https://registry.docker-cn.com%26quot%3B/" target="_blank" rel="noopener noreferrer">https://registry.docker-cn.com&quot;</a></p></li><li><p>阿里云 容器镜像服务--镜像中心--镜像加速器 <a href="https://xc8hlpxv.mirror.aliyuncs.com/" target="_blank" rel="noopener noreferrer">https://xc8hlpxv.mirror.aliyuncs.com</a></p></li></ul><p>您可以通过修改daemon配置文件/etc/docker/daemon.json来使用加速器</p><div class="language-bash"><pre><code><span class="token function">sudo</span> <span class="token function">usermod</span> -aG <span class="token function">docker</span> <span class="token environment constant">$USER</span> <span class="token comment"># $SUDO_USER</span>
<span class="token function">sudo</span> <span class="token function">usermod</span> -aG <span class="token function">docker</span> <span class="token variable">$SUDO_USER</span>
<span class="token function">sudo</span> <span class="token function">chmod</span> <span class="token number">666</span> /var/run/docker.sock
<span class="token function">sudo</span> <span class="token function">mkdir</span> -p /etc/docker
<span class="token function">sudo</span> <span class="token function">tee</span> /etc/docker/daemon.json <span class="token operator">&lt;&lt;-</span><span class="token string">&#39;EOF&#39;
{
  &quot;registry-mirrors&quot;: [
    &quot;http://hub-mirror.c.163.com&quot;,
    &quot;https://registry.docker-cn.com&quot;,
    &quot;https://xc8hlpxv.mirror.aliyuncs.com&quot;,
    &quot;https://docker.mirrors.ustc.edu.cn&quot;,
    &quot;http://f1361db2.m.daocloud.io&quot;
  ],
  &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;],
  &quot;max-concurrent-downloads&quot;: 10,
  &quot;max-concurrent-uploads&quot;: 5,
  &quot;log-driver&quot;: &quot;json-file&quot;,
  &quot;log-opts&quot;: {
    &quot;max-size&quot;: &quot;300m&quot;,
    &quot;max-file&quot;: &quot;2&quot;
  },
  &quot;live-restore&quot;: true
}
EOF</span>
<span class="token function">sudo</span> systemctl daemon-reload
<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> --now <span class="token function">docker</span>
<span class="token function">sudo</span> systemctl restart <span class="token function">docker</span>

<span class="token comment"># 查看配置的加速器生效</span>
<span class="token function">docker</span> info
</code></pre></div><ul><li>daocloud <a href="https://www.daocloud.io/mirror" target="_blank" rel="noopener noreferrer">https://www.daocloud.io/mirror</a></li></ul><div class="language-bash"><pre><code><span class="token function">curl</span> -sSL https://get.daocloud.io/daotools/set_mirror.sh <span class="token operator">|</span> <span class="token function">sh</span> -s http://f1361db2.m.daocloud.io
</code></pre></div><p>该脚本可以将 --registry-mirror 加入到你的 Docker 配置文件 /etc/docker/daemon.json 中。适用于 Ubuntu14.04、Debian、CentOS6 、CentOS7、Fedora、Arch Linux、openSUSE Leap 42.1</p><h3 id="配置docker-cgroup驱动systemd" tabindex="-1">配置docker cgroup驱动systemd <a class="header-anchor" href="#配置docker-cgroup驱动systemd" aria-hidden="true">#</a></h3><p>关于cgroup驱动，参考 <a href="https://docs.docker.com/engine/reference/commandline/dockerd/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/engine/reference/commandline/dockerd/</a></p><ul><li>cgroup v1 <code>sudo grubby --update-kernel=ALL --args=&quot;systemd.unified_cgroup_hierarchy=0&quot;</code></li><li>cgroup v2 <code>sudo grubby --update-kernel=ALL --args=&quot;systemd.unified_cgroup_hierarchy=1&quot;</code></li></ul><div class="language-bash"><pre><code><span class="token comment"># 查看</span>
<span class="token function">docker</span> info <span class="token operator">|</span><span class="token function">grep</span> Cgroup

<span class="token comment"># 1. /etc/docker/daemon.json</span>
<span class="token string">&quot;exec-opts&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&quot;native.cgroupdriver=systemd&quot;</span><span class="token punctuation">]</span>

<span class="token comment"># 2.</span>
/usr/lib/systemd/system/docker.service
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/bin/dockerd -H fd:// --containerd<span class="token operator">=</span>/run/containerd/containerd.sock --exec-opt native.cgroupdriver<span class="token operator">=</span>systemd
systemctl daemon-reload
systemctl restart <span class="token function">docker</span>
</code></pre></div><h3 id="配置docker-proxy代理" tabindex="-1">配置docker proxy代理 <a class="header-anchor" href="#配置docker-proxy代理" aria-hidden="true">#</a></h3><div class="language-bash"><pre><code><span class="token assign-left variable">HTTP_PROXY</span><span class="token operator">=</span>http://6.86.3.12:3128
<span class="token comment"># HTTP_PROXY=http://172.17.1.250:3128</span>
<span class="token function">mkdir</span> /etc/systemd/system/docker.service.d
<span class="token function">tee</span> /etc/systemd/system/docker.service.d/http-proxy.conf <span class="token operator">&lt;&lt;</span><span class="token string">EOF
[Service]
Environment=&quot;HTTP_PROXY=<span class="token variable">$HTTP_PROXY</span>&quot;
Environment=&quot;HTTPS_PROXY=<span class="token variable">$HTTP_PROXY</span>&quot;
Environment=&quot;NO_PROXY=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,127.0.0.1/8,6.86.0.0/16&quot;
EOF</span>

systemctl daemon-reload
<span class="token comment"># 验证配置</span>
systemctl show --property Environment <span class="token function">docker</span>
<span class="token comment"># 重启docker</span>
systemctl restart <span class="token function">docker</span>

</code></pre></div><h3 id="配置docker-container使用的-proxy代理" tabindex="-1">配置docker container使用的 proxy代理 <a class="header-anchor" href="#配置docker-container使用的-proxy代理" aria-hidden="true">#</a></h3><p><a href="https://docs.docker.com/network/proxy/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/network/proxy/</a></p><div class="language-bash"><pre><code><span class="token comment"># 1</span>
<span class="token function">docker</span> container run <span class="token punctuation">\</span>
  -e <span class="token assign-left variable">HTTP_PROXY</span><span class="token operator">=</span>http://username:password@proxy2.domain.com <span class="token punctuation">\</span>
  -e <span class="token assign-left variable">HTTPS_PROXY</span><span class="token operator">=</span>http://username:password@proxy2.domain.com <span class="token punctuation">\</span>
  myimage

<span class="token comment"># 2</span>
<span class="token function">mkdir</span> ~/.docker
<span class="token function">tee</span> ~/.docker/config.json <span class="token operator">&lt;&lt;</span><span class="token string">EOF
{
 &quot;proxies&quot;:
 {
   &quot;default&quot;:
   {
     &quot;httpProxy&quot;: &quot;http://6.86.3.12:3128&quot;,
     &quot;httpsProxy&quot;: &quot;http://6.86.3.12:3128&quot;,
     &quot;noProxy&quot;: &quot;10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,127.0.0.1/8,6.86.0.0/16&quot;
   }
 }
}
EOF</span>
</code></pre></div><h3 id="第一个镜像" tabindex="-1">第一个镜像 <a class="header-anchor" href="#第一个镜像" aria-hidden="true">#</a></h3><div class="language-bash"><pre><code><span class="token function">docker</span> run hello-world

</code></pre></div></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-07c132fc><div class="edit" data-v-07c132fc><div class="edit-link" data-v-07c132fc data-v-1ed99556><!----></div></div><div class="updated" data-v-07c132fc><!----></div></footer><!----><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"cloudnative_docker_docker-dockerfile.md\":\"4278300a\",\"cloudnative_docker_docker-compose.md\":\"b71d19c3\",\"cloudnative_docker_docker-container.md\":\"8da5f169\",\"cloudnative_docker_docker-image-mysql.md\":\"a8935afb\",\"cloudnative_docker_docker-image-tomcat.md\":\"db561da6\",\"cloudnative_docker_docker-image.md\":\"94ac0af2\",\"cloudnative_docker_docker-install.md\":\"6cba41c5\",\"cloudnative_docker_docker-registry.md\":\"30c460a6\",\"cloudnative_docker_docker-volume.md\":\"f6d0a382\",\"cloudnative_docker_index.md\":\"7f785a3c\",\"cloudnative_k8s_index.md\":\"904ed499\",\"cloudnative_terraform_index.md\":\"74416ce6\",\"cloudnative_vmware_index.md\":\"3e2e4def\",\"game_ahk_index.md\":\"d5284f33\",\"game_d3_index.md\":\"f49487ff\",\"game_poe_index.md\":\"adc1cc54\",\"guide_index.md\":\"b6832392\",\"index.md\":\"23208123\",\"linux_command_index.md\":\"315bc2aa\",\"linux_command_jjj_join.md\":\"487602fe\",\"linux_command_nnn_nc.md\":\"bfc30317\",\"linux_distro_alpine_alpine-install.md\":\"74e69fa2\",\"linux_distro_alpine_index.md\":\"0d5881e1\",\"linux_distro_index.md\":\"9c21d59a\",\"linux_index.md\":\"51ba410d\",\"linux_rootfs_index.md\":\"e7a60d3f\",\"linux_service_ggg_gitlab-ce-install.md\":\"42bd0706\",\"linux_service_index.md\":\"de40cacf\",\"linux_service_sss_ssh-tunnel.md\":\"6fb68b79\",\"linux_service_sss_ssh.md\":\"422b4dbf\",\"network_index.md\":\"c9153ddb\",\"powershell_index.md\":\"db266a44\",\"python_base_index.md\":\"114dc00b\",\"python_index.md\":\"ef4041b4\",\"python_module_index.md\":\"2bcf8cac\",\"shell_index.md\":\"9b726a41\",\"vscode_index.md\":\"b8957a73\",\"web_css_index.md\":\"5f4a57a9\",\"web_es6_index.md\":\"aae7a337\",\"web_html_index.md\":\"e1a81082\",\"web_index.md\":\"8d52b991\",\"web_javascript_index.md\":\"38cdf7cc\",\"web_typescript_index.md\":\"be909522\",\"web_vue_index.md\":\"73dff249\",\"windows_index.md\":\"4d35f366\",\"windows_software.md\":\"0a4ddb94\"}")</script>
    <script type="module" async src="/assets/app.3a9754ab.js"></script>
    
  </body>
</html>